YUI.add("moodle-local_kaltura-ltipanel",function(t,e){var n,i,d=function(){d.superclass.constructor.apply(this,arguments)};t.extend(d,t.Base,{modulename:null,addvidbtnid:null,init:function(e){"0"!==e.addvidbtnid&&"0"!==e.ltilaunchurl&&0!==e.courseid&&0!==e.height&&0!==e.width?(this.modulename=e.modulename,this.addvidbtnid=e.addvidbtnid,t.one("#"+e.addvidbtnid).on("click",this.open_bse_popup_callback,this,e.ltilaunchurl,e.height,e.width)):alert("Some parameters were not initialized.")},open_bse_popup_callback:function(e,t,n,i){var d=window.screenLeft!=undefined?window.screenLeft:screen.left,o=window.screenTop!=undefined?window.screenTop:screen.top,d=(window.innerWidth||document.documentElement.clientWidth||screen.width)/2-600+d,o=(window.innerHeight||document.documentElement.clientHeight||screen.height)/2-350+o,t=window.open(t,M.util.get_string("browse_and_embed","local_kaltura"),"scrollbars=yes, width=1200, height=700, top="+o+", left="+d);window.focus&&t.focus(),document.body.bsePopup=t,o=this.createEntrySelectedEvent(),document.body.entrySelectedEvent=o,document.body.addEventListener("entrySelected",this.close_popup_callback.bind(this),!1)},createEntrySelectedEvent:function(){var e;return"function"==typeof window.CustomEvent?e=new CustomEvent("entrySelected"):(e=document.createEvent("CustomEvent")).initCustomEvent("entrySelected",!1,!1,{}),e},close_popup_callback:function(){var e=t.one("img[id=video_thumbnail]");e.setStyle("display","none"),(e=t.one("iframe[id=contentframe]")).setAttribute("width",t.one("input[id=width]").getAttribute("value")),e.setAttribute("height",t.one("input[id=height]").getAttribute("value")),e.setStyle("display","inline"),e=t.one("input[name=modulename]"),undefined!==e&&"kalvidres"===this.modulename&&this.lti_panel_change_add_media_button_caption(),document.body.bsePopup.close()},lti_panel_change_add_media_button_caption:function(){var e=M.util.get_string("replace_video",this.modulename);e!==t.one("#"+this.addvidbtnid).getAttribute("value")&&t.one("#"+this.addvidbtnid).setAttribute("value",e)}},{NAME:"moodle-local_kaltura-ltipanel",ATTRS:{addvidbtnid:{value:"0"},ltilaunchurl:{value:"0"},height:{value:0},width:{value:0},modulename:{value:""}}}),t.extend(n=function(){n.superclass.constructor.apply(this,arguments)},t.Base,{init:function(e){"0"!==e.addvidbtnid&&"0"!==e.ltilaunchurl&&0!==e.courseid&&0!==e.height&&0!==e.width&&t.one("#"+e.addvidbtnid).on("click",this.open_bse_popup_callback,this,e.ltilaunchurl,e.height,e.width)},open_bse_popup_callback:function(e,t,n,i){var d=window.screenLeft!=undefined?window.screenLeft:screen.left,o=window.screenTop!=undefined?window.screenTop:screen.top,d=(window.innerWidth||document.documentElement.clientWidth||screen.width)/2-600+d,o=(window.innerHeight||document.documentElement.clientHeight||screen.height)/2-350+o,t=window.open(t,M.util.get_string("browse_and_embed","local_kaltura"),"scrollbars=yes, width=1200, height=700, top="+o+", left="+d);window.focus&&t.focus(),document.body.bsePopup=t,o=this.createEntrySelectedEvent(),document.body.entrySelectedEvent=o,document.body.addEventListener("entrySelected",this.close_popup_callback.bind(this),!1)},createEntrySelectedEvent:function(){var e;return"function"==typeof window.CustomEvent?e=new CustomEvent("entrySelected"):(e=document.createEvent("CustomEvent")).initCustomEvent("entrySelected",!1,!1,{}),e},close_popup_callback:function(){var e;t.one("input[id=submit_video]").removeAttribute("disabled"),t.one("img[id=video_thumbnail]").setStyle("display","none"),(e=t.one("iframe[id=contentframe]")).setAttribute("width",t.one("input[id=width]").getAttribute("value")),e.setAttribute("height",t.one("input[id=height]").getAttribute("value")),e.setStyle("display","inline"),t.one("#id_add_video").set("value",M.util.get_string("replacevideo","kalvidassign")),t.one("#id_add_video").addClass("btn-secondary"),t.one("#submit_video").addClass("btn-primary"),t.one("#id_add_video").removeClass("btn-primary"),t.one("#submit_video").removeClass("btn-secondary"),document.body.bsePopup.close()}},{NAME:"moodle-local_kaltura-ltipanel",ATTRS:{addvidbtnid:{value:"0"},ltilaunchurl:{value:"0"},height:{value:0},width:{value:0}}}),t.extend(i=function(){i.superclass.constructor.apply(this,arguments)},t.Base,{ltimediaassignment:null,init:function(e){this.ltimediaassignment=e,t.one("form[id=fastgrade]").delegate("click",this.review_submission,"a[name=submission_source]",this)},review_submission:function(e){var t,n;e.preventDefault(),e=(n=(t=(e.target.test("a")?e.target:e.target.ancestor("a[name=submission_source]")).getAttribute("href"),e.target.ancestor("div[name=media_submission]").get("childNodes").filter("input[name=height]").get("value")),e.target.ancestor("div[name=media_submission]").get("childNodes").filter("input[name=width]").get("value")),this.ltimediaassignment.open_bse_popup_callback(null,t,n,e)}},{NAME:"moodle-local_kaltura-ltipanel"}),M.local_kaltura=M.local_kaltura||{},M.local_kaltura.init=function(e){return new d(e)},M.local_kaltura.initmediaassignment=function(e){return new n(e)},M.local_kaltura.initreviewsubmission=function(){var e={addvidbtnid:"0",ltilaunchurl:"0",courseid:0,height:0,width:0},e=new n(e);return new i(e)}},"@VERSION@",{requires:["base","node","panel","node-event-simulate"]});